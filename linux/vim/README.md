# VI 편집기
<!-- - https://wikidocs.net/73289 -->
## 1. VI 편집기란?
- **VI** sual display editor의 약자
- VI는 터미널 환경에서 많이 사용되는 텍스트 에디터로, <br> 리눅스 뿐 아니라 윈도우용 vim도 배포되어 있다.
- VIM(VI Improved)은 VI를 개선하여 만들어진 프로그램
- VIM이 VI로 alias(별칭)가 등럭되어 있다면 VI를 입력하면 자동으로 VIM이 실행된다
- 쉘 상에서 `vi 파일명` 을 입력하여 새로운 문서를 편집할 수 있다

---

## 2. VI 사용 모드
### 1. 명령 모드(command mode)
 - 처음 vi를 시작하면 들어가지는 **기본 상태** <br>
 - 이 모드는 vi에게 **명령** 을 내리는 모드고, 편집을 위한 모드가 **아니다**<br>
 - 키 입력으로 삭제, 복사, 붙이기 등의 작업을 하는 모드<br>
 - 명령 모드로 되돌아 오기 위해서는 <kbd>esc</kbd>를 누르면 된다<br>

   
### 2. 입력 모드(insert mode)
 - 실제로 문서를 편집하는 모드<br>
 - 명령모드에서 <kbd>i</kbd>나 <kbd>a</kbd>, o, s, a 키를 통해 들어올 수 있다. <br> 
 - 자유롭게 코드나 글을 작성할 수 있다. <br>
 - **복사, 붙이기** 와 같은 기능은 입력모드에서 할 수 없고, **명령 모드** 로 이동해야 한다.<br>
    
### 3. EX 모드
 - vim은 ex에디터를 기반으로 만들어진 에디터이므로 ex에디터 기능을 그대로 사용할 수 있다<br>
 - ex라인 에디터의 기능을 기본적으로 사용할 수 있는 것이 EX모드이다<br>
 - 명령 모드에서 <kbd>:</kbd> 을 입력해 진입한다. <br>
 - Ex명령어를 실행한다<br>
 - `syntax on` 명령: 문법 강조 기능 on/off<br>
 
### 3. 비주얼모드(visual mode):
 - 명령 모드에서 <kbd>v</kbd> 를 입력해 진입한다.
  
---
## 3. 편집 명령

### - vi 시작
- vi에 진입하고 싶을 때 사용하는 명령어

| 명령어 | 설명 |
| :---: | --- |
| vi 파일명| 파일을 열고 작성<br> (만일 해당 파일이 없다면 생성한다) |
| view | 읽기 전용으로 파일 열기 |
| view | 읽기 전용으로 파일 열기 |
<br>


### - 커서 이동
- **키보드 방향키** 로도 이동 가능
- 명령 모드에서 실행

| 명령어 | 설명 |
| :---: | --- |
| j | 아래로 이동 |
| k | 위로 이동 |
| l | 오른쪽으로 이동 |
| m | 왼쪽으로 이동 |
<br>


### - 입력 모드 변경
- 명령 모드에서 입력 모드로 진입할 때, 다양한 키(i, o, ...)를 선택했다. <br>
이러한 키는 어느 위치에 문자를 삽입할지 결정한다<br>
- 입력 모드로 진입하기 위한 키는 다음과 같다<br>

| 명령어 | 설명 |
| :---: | --- |
| **i** | 현재 위치에사 문자 삽입( **insert** ) |
| **a** | 현재 위치의 다음 칸부터 문자 삽입 ( **append** ) |
| **o** | 커서 바로 아래에 줄을 만들고 문자 삽입 ( **open line** ) |
| O | 커서 바로 위에 줄을 만들고 문자 삽입|
| A | 현재 커서가 위치한 줄의 마지막 위치에서 문자 삽입 |
| I | 현재 커서가 위치한 줄의 맨 앞에서 문자 삽입 |
| gg | 첫 라인으로 이동하여 문자 삽입|
| G | 마지막 라인으로 이동하여 문자 삽입|
<br>

### - 삭제
- 입력 모드에서 문서를 편집하다가, 삭제하고 싶은 문자가 생길 때 사용<br>
- **명령 모드** 로 진입하여 사용

| 명령어 | 설명 |
| :---: | --- |
| **x**, dI | - 커서 위치의 문자 삭제<br>- x의 개수만큼 문자 삭제(xxx은 문자 3개 삭제) |
| **dd** | 커서가 있는 행 전체 삭제 |
| X, dh | 커서 위치 바로 앞의 문자 삭제 |
| dw | 한 단어 삭제 |
| d0 | 커서가 위치한 곳부터 그 행의 맨 앞 문자까지 삭제(왼쪽 삭제) |
| D, d$ | 커서가 위치한 곳부터 그 행의 마지막 문자까지 삭제(오른쪽 삭제) |
| dk | 커서가 위치한 행과 그 앞 행 삭제 |
| dj | 커서가 위치한 행과 그 다음 행 삭제 |
| dG | 커서가 위치한 행부터 마지막 행까지 삭제 |
| :2,3d | 2번째~3번째 행 삭제 |

> 응용: **화면 전체 삭제**
> 1. 명령 모드에서 `gg`를 눌러 커서를 **첫 라인** 으로 이동 <br>
> 2. (그대로) 명령 모드에서 `dG`를 입력해 **맨 뒷줄까지 삭제** <br>
> -> **모든 화면 삭제 완료**

<br>

### - 되돌리기
- window의 ctrl + z, ctrl + y와 같은 기능<br>
- 입력 모드에서 문서를 편집하다가, 되돌리고 싶을 때 사용
- **명령모드** 에서 실행

| 명령어 | 설명 |
| :---: | --- |
| u | 되돌리기(window의 ctrl + z) |
| <kbd>ctrl</bkd> + r | redo (widow의 ctrl + y) |

<br>

### - 복사, 붙여넣기
- window의 ctrl + c, ctrl + v와 같은 기능
- 입력 모드에서 문서를 편집하다가, 문자를 복사/붙여넣기하고 싶을 때 사용
- **명령모드** 에서 실행

| 명령어 | 설명 |
| :---: | --- |
| yw | 커서 위치에서 단어의 끝까지 복사 |
| y2w | 커서 위치에서 단어 2개 복사 |
| y0 | 커서 위치에서 해당 행의 맨 처음까지 복사(왼쪽 복사) |
| y$ | 커서 위치에서 해당 행의 맨 끝까지 복사(오른쪽 복사) |
| **yy** | 커서가 위치한 줄 복사 |
| 2yy | 커서가 위치한 줄을 포함해 아래로 2줄 복사 |
| yj | 커서가 위치한 줄과 그 다음줄 복사 |
| yk | 커서가 위치한 줄과 그 앞줄 복사 |
| yG | 커서가 위치에서 파일 끝까지 복사 |
| p | 커서 바로 다음 위치에 붙여넣기 |
| P | 커서가 있는 위치에 붙여넣기 |

> 응용: **원하는 블록만 복사**
> 1. 명령 모드에서 v키를 누르고 커서를 이동해 블록 설정
> 2. y키를 눌러 (캐시에) 복사한다
> 3. p를 눌러 붙여넣기한다

<br>

### 저장, 종료
- 명령모드에서 ex모드로 들어와(: 입력) 작업
- 만일 입력 모드에서 문서를 작성한다면 <kbd>esc</kbd> -> <kbd>:</kbd> 를 눌러 진입

| 명령어 | 설명 |
| :---: | --- |
| **wq** | 저장 후 종료 |
| wq! | 강제 저장 후 종료 |
| q! | vi 강제 종료 |
| W | 파일 저장 |
| W 파일명 | 파일명으로 파일 저장 |
| q | vi 종료(파일 저장 x) |
| set nu | 작성한 파일의 라인 번호 출력 |
| set nonu | 작성한 파일의 라인 번호 출력 취소 |

<br>

### -검색, 대체
- 명령모드에서 **ex모드** 로 들어와(<kbd>:</kbd> 입력) 작업
- 대체 명령어 꼴은 다음과 같다: _[범위]/[매칭 문자열]/[치환 문자열]/[라인 범위]_
- 만일 라인 범위로 g를 사용하지 않는다면, <br>한 라인에 해당 매칭 문자열이 **2개 이상** 존재할 때 2번째 이상부터의 문자열은 **치환이 이뤄지지 않는다**

| 명령어 | 설명 |
| :---: | --- |
| ?문자열 | 커서 위치에서 왼쪽, 위로 파일 첫번째까지 탐색 |
| /문자열 | 커서 위치에서 오른쪽, 아래로 파일 마지막까지 탐색 |
| s/문자열1/문자열2/g | 모든 문자열1을 문자열 2로 대체 |
| s/문자열1/문자열2| 현재 커서가 있는 행의 문자열1을 문자열 2로 대체 |
| 1,3s/문자열1/문자열2/g | 1~3행에서 문자열 1을 문자열 2로 대체 |
| -1,+3s/문자열1/문자열2/g | 현재 커서에서 위로 1개, 아래로 3개 행에서<br> 문자열 1을 문자열 2로 대체(현재 커서 행도 포함) |

### - VI 스크립트 자체 명령어


```console
# 파일 열기
$ vim hello.c
```
- 기존 hello.c파일이 존재하면 그것을 열고, 만일 존재하지 않으면 새로 생성한다.
  
  
  
  
  
  
   <!--
   - 파일 저장 시 사용되는 명령어
   | 명령어 | |
   | :---: | --- |
   | :w ||
   - gg: 첫 라인으로 커서 이동<br>
   - G: 마지막 라인으로 커서 이동<br>
   - u: 되돌리기<br>
   - y: 복사<br>
   - p: 붙여넣기<br>
   - x: 현재 위치 삭제(del과 같은 기능)<br>
   - X: 커서 앞의 문자 삭제(백스페이스와 같은 기능)<br>
   - d: 지정한 영역(v 또는 g로 지정) 삭제<br>
   - D: 커서가 존재하는 한 줄에 대해 커서 이후의 모든 글자 삭제<br>
   - dd: 현재 라인 삭제<br>
   - dG: 현재 라인부터 마지막 라인까지 삭제<br>
   - /: 전진 검색<br>
   - ?: 후진 검색<br>
   - %: 문자열 치환<br>
   -->


```
root@/~# select-editor
 
Select an editor.  To change later, run 'select-editor'.
  1. /bin/nano        <---- easiest
  2. /usr/bin/vim.basic
  3. /usr/bin/vim.tiny
  4. /bin/ed
 
Choose 1-4 [1]: 2
```

